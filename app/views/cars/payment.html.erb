<h1>Payment Calculator</h1>

<div class="jumbotron">
  <%= form_for @car, url: payment_calculator_path(@car), html: {class: 'form-horizontal', role: 'form'} do |f| %>
      <div class="form-group">
        <%= label_tag 'make', 'Make', class: 'col-md-4 control-label' %>
        <div class="col-md-8">
          <%= text_field_tag 'make', @car.make, disabled: true %>
        </div>
      </div>
      <div class="form-group">
        <%= label_tag 'model', 'Model', class: 'col-md-4 control-label' %>
        <div class="col-md-8">
          <%= text_field_tag 'model', @car.model, disabled: true %>
        </div>
      </div>
      <div class="form-group">
        <%= label_tag 'year', 'Year', class: 'col-md-4 control-label' %>
        <div class="col-md-8">
          <%= text_field_tag 'year', @car.year, disabled: true %>
        </div>
      </div>
      <div class="form-group">
        <%= label_tag 'price', 'Price', class: 'col-md-4 control-label' %>
        <div class="col-md-8">
          <%= text_field_tag 'price', number_to_currency(@car.price), disabled: true %>
        </div>
      </div>
      <div class="form-group">
        <%= label_tag 'interest_rate', 'Interest Rate', class: 'col-md-4 control-label' %>
        <div class="col-md-8">
          <%= text_field_tag 'interest_rate', params[:interest_rate] %>
        </div>
      </div>
      <div class="form-group">
        <%= label_tag 'payment_amount', 'Payment Amount', class: 'col-md-4 control-label' %>
        <div class="col-md-8">
          <%= text_field_tag 'payment_amount', params[:payment_amount] %>
        </div>
      </div>
      <div class="actions">

      </div>
      <div class="form-group">
        <div class="col-md-offset-4 col-md-8">
          <%= f.submit 'Calculate', class: "btn btn-success" %>
        </div>
      </div>
  <% end %>

</div>

<% if @payment_calculator %>
    <table id="payments" class="table table-hover">
      <tr>
        <th>Date</th>
        <th>Payment</th>
        <th>Principle</th>
        <th>Interest</th>
        <th>New Balance</th>
      </tr>
      <tr>
        <td><%= Date.today %></td>
        <td colspan="3">&nbsp;</td>
        <td><%= number_to_currency(@payment_calculator.total_owed) %></td>
      </tr>
      <%= render :partial => 'loan_payment',
                 :collection => @payment_calculator.payments(params[:interest_rate].to_f, params[:payment_amount].to_i) %>
    </table>
<% end %>
